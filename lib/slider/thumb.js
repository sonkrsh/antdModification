"use strict";"use client";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeGestureHandler=require("react-native-gesture-handler");var _reactNativeReanimated=_interopRequireWildcard(require("react-native-reanimated"));var _HapticsContext=_interopRequireDefault(require("../provider/HapticsContext"));var _tooltip=_interopRequireDefault(require("../tooltip"));var _thumbIcon=require("./thumb-icon");function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}var Thumb=function Thumb(props){var value=props.value,min=props.min,max=props.max,trackLayout=props.trackLayout,disabled=props.disabled,icon=props.icon,residentPopover=props.residentPopover,onDrag=props.onDrag,style=props.style,styles=props.styles;var _useState=(0,_react.useState)(),_useState2=(0,_slicedToArray2.default)(_useState,2),thumbLayout=_useState2[0],setThumbLayout=_useState2[1];var handleLayout=function handleLayout(e){setThumbLayout(e.nativeEvent.layout);};var animatedStyles=(0,_reactNativeReanimated.useAnimatedStyle)(function(){return{transform:[{translateX:(value-min)/(max-min)*((trackLayout===null||trackLayout===void 0?void 0:trackLayout.width)||0)-((thumbLayout===null||thumbLayout===void 0?void 0:thumbLayout.width)||0)/2}]};},[max,min,thumbLayout===null||thumbLayout===void 0?void 0:thumbLayout.width,trackLayout===null||trackLayout===void 0?void 0:trackLayout.width,value]);var _useState3=(0,_react.useState)(false),_useState4=(0,_slicedToArray2.default)(_useState3,2),dragging=_useState4[0],setDragging=_useState4[1];var onHaptics=(0,_react.useContext)(_HapticsContext.default);var gesture=_reactNativeGestureHandler.Gesture.Pan().enabled(!disabled).onBegin(function(){return(0,_reactNativeReanimated.runOnJS)(onHaptics)('slider');}).onUpdate(function(e){!dragging&&(0,_reactNativeReanimated.runOnJS)(setDragging)(true);(0,_reactNativeReanimated.runOnJS)(onDrag)(e.absoluteX-((thumbLayout===null||thumbLayout===void 0?void 0:thumbLayout.width)||0));}).onEnd(function(e){(0,_reactNativeReanimated.runOnJS)(onDrag)(e.absoluteX-((thumbLayout===null||thumbLayout===void 0?void 0:thumbLayout.width)||0),true);}).onFinalize(function(){(0,_reactNativeReanimated.runOnJS)(setDragging)(false);});var renderPopoverContent=typeof props.popover==='function'?props.popover:props.popover?function(val){return val.toString();}:null;var thumbElement=icon?icon:_react.default.createElement(_thumbIcon.ThumbIcon,null);return _react.default.createElement(_reactNativeGestureHandler.GestureDetector,{gesture:gesture},_react.default.createElement(_reactNativeReanimated.default.View,{onStartShouldSetResponder:function onStartShouldSetResponder(){return true;},style:[styles.thumb,animatedStyles,style],onLayout:handleLayout},renderPopoverContent?_react.default.createElement(_tooltip.default,{content:renderPopoverContent(value),placement:"top",visible:residentPopover||dragging,mode:"dark"},_react.default.createElement(_reactNative.View,{style:{flex:1}},thumbElement)):thumbElement));};var _default=Thumb;exports.default=_default;